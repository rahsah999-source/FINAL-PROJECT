import random

def create_exam(question_bank_path, num_questions, output_file):
    """
    Reads a question bank, randomly selects a specified number of questions,
    and saves them to an output file.
    """
    try:
        # Open and read all lines from the file
        with open(question_bank_path, 'r', encoding='utf-8') as f:
            lines = f.readlines()
    except FileNotFoundError:
        print(f"Error: The file at {question_bank_path} was not found.")
        return False

    # Create a list of (question, answer) pairs
    qa_pairs = []
    # Loop through lines taking two at a time (Question and Answer)
    for i in range(0, len(lines), 2):
        if i + 1 < len(lines):
            # .strip() removes whitespace, including the newline character '\n'
            question = lines[i].strip()
            answer = lines[i+1].strip()
            if question and answer: # Only add if both are non-empty
                 qa_pairs.append((question, answer))

    # Check if we have enough questions
    if len(qa_pairs) < num_questions:
        print("Error: The question bank does not have enough questions.")
        return False

    # Randomly select a sample of question-answer pairs
    selected_qa = random.sample(qa_pairs, num_questions)

    # Save the exam to the output file
    try:
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write("--- EXAM GENERATED BY PROFESSOR ASSISTANT ---\n\n")
            for i, (q, a) in enumerate(selected_qa, 1):
                # Write the Question for the exam
                f.write(f"Question {i}: {q}\n")
                # Write the Answer (for the professor's answer key)
                f.write(f"Answer: {a}\n\n")
        return True
    except Exception as e:
        print(f"Error writing to output file {output_file}: {e}")
        return False

def main():
    """
    Main function to run the Professor Assistant program, handling user interaction.
    """
    # 1. Welcome
    print("Welcome to professor assistant version 1.0.") # [cite: 70]
    
    # 2. Get Name
    prof_name = input("Please Enter Your Name: ") # [cite: 71]
    
    # 3. Greeting (Matches the exact format, including the period after 'Professor.')
    print(f"Hello Professor. {prof_name}, I am here to help you create exams from a question bank.") # [cite: 72]

    while True:
        # 4. Ask for exam creation
        choice = input("Do you want me to help you create an exam (Yes to proceed | No to quit the program)? ").strip().lower() # [cite: 73, 79]

        if choice == 'yes':
            # 5. Get path
            q_bank_path = input("Please Enter the Path to the Question Bank: ") # [cite: 74]
            
            # **REQUIRED CONFIRMATION PRINT STATEMENT** [cite: 75]
            print("Yes, indeed the path you provided includes questions and answers.")
            
            # 6. Get number of questions
            try:
                num_q = int(input("How many question-answer pairs do you want to include in your exam? ")) # [cite: 76]
            except ValueError:
                print("Invalid input. Please enter a number for the quantity of questions.")
                continue

            # 7. Get output path
            output_path = input("Where do you want to save your exam? ") # [cite: 77]

            # 8. Create exam and print success
            if create_exam(q_bank_path, num_q, output_path):
                print(f"Congratulations Professor {prof_name}. Your exam is created and saved in {output_path}.") # [cite: 78]
        
        elif choice == 'no':
            # 9. Final message and exit
            break
        else:
            print("Invalid input. Please enter 'Yes' or 'No'.")

    # 10. Final message
    print(f"Thank you professor {prof_name}. Have a good day!") # [cite: 80]

if __name__ == "__main__":
    main()
